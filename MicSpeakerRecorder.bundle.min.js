"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function _typeof(e){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}(function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t():"function"==typeof define&&define.amd?define("MicSpeakerRecorder",[],t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?exports.MicSpeakerRecorder=t():e.MicSpeakerRecorder=t()})(self,function(){return function(){function e(i){var r=a[i];if(void 0!==r)return r.exports;var o=a[i]={exports:{}};return t[i](o,o.exports,e),o.exports}var t={204:function _(e,t,a){function i(e,t){function i(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}function r(){if(!l){var e=u.length,t=!1,a=[];if(u.forEach(function(e){e.stream||(e.stream={}),e.stream.fullcanvas?t=e:a.push(e)}),t)g.width=t.stream.width,g.height=t.stream.height;else if(a.length){g.width=1<e?2*a[0].width:a[0].width;var i=1;(3===e||4===e)&&(i=2),(5===e||6===e)&&(i=3),(7===e||8===e)&&(i=4),(9===e||10===e)&&(i=5),g.height=a[0].height*i}else g.width=p.width||360,g.height=p.height||240;t&&t instanceof HTMLVideoElement&&o(t),a.forEach(function(e,t){o(e,t)}),setTimeout(r,p.frameInterval)}}function o(e,t){if(!l){var a=0,i=0,r=e.width,o=e.height;1===t&&(a=e.width),2===t&&(i=e.height),3===t&&(a=e.width,i=e.height),4===t&&(i=2*e.height),5===t&&(a=e.width,i=2*e.height),6===t&&(i=3*e.height),7===t&&(a=e.width,i=3*e.height),"undefined"!=typeof e.stream.left&&(a=e.stream.left),"undefined"!=typeof e.stream.top&&(i=e.stream.top),"undefined"!=typeof e.stream.width&&(r=e.stream.width),"undefined"!=typeof e.stream.height&&(o=e.stream.height),m.drawImage(e,a,i,r,o),"function"==typeof e.stream.onRender&&e.stream.onRender(m,a,i,r,o,t)}}function d(){c();var e;"captureStream"in g?e=g.captureStream():"mozCaptureStream"in g?e=g.mozCaptureStream():!p.disableLogs&&console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var t=new b;return e.getTracks().filter(function(e){return"video"===e.kind}).forEach(function(e){t.addTrack(e)}),g.stream=t,t}function n(){v.AudioContextConstructor||(v.AudioContextConstructor=new v.AudioContext),p.audioContext=v.AudioContextConstructor,p.audioSources=[],!0===p.useGainNode&&(p.gainNode=p.audioContext.createGain(),p.gainNode.connect(p.audioContext.destination),p.gainNode.gain.value=0);var t=0;if(e.forEach(function(e){if(e.getTracks().filter(function(e){return"audio"===e.kind}).length){t++;var a=p.audioContext.createMediaStreamSource(e);!0===p.useGainNode&&a.connect(p.gainNode),p.audioSources.push(a)}}),!!t)return p.audioDestination=p.audioContext.createMediaStreamDestination(),p.audioSources.forEach(function(e){e.connect(p.audioDestination)}),p.audioDestination.stream}function s(e){var a=document.createElement("video");return i(e,a),a.className=t,a.muted=!0,a.volume=0,a.width=e.width||p.width||360,a.height=e.height||p.height||240,a.play(),a}function c(t){u=[],t=t||e,t.forEach(function(e){if(e.getTracks().filter(function(e){return"video"===e.kind}).length){var t=s(e);t.stream=e,u.push(t)}})}(function(e){"undefined"==typeof RecordRTC&&e&&"undefined"==typeof window&&"undefined"!=typeof a.g&&(a.g.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function getUserMedia(){}},!a.g.console&&(a.g.console={}),("undefined"==typeof a.g.console.log||"undefined"==typeof a.g.console.error)&&(a.g.console.error=a.g.console.log=a.g.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(e.document={documentElement:{appendChild:function appendChild(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function getContext(){return e},play:function play(){},pause:function pause(){},drawImage:function(){},toDataURL:function toDataURL(){return""},style:{}};return e},e.HTMLVideoElement=function(){}),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}),"undefined"==typeof f&&(e.URL={createObjectURL:function createObjectURL(){return""},revokeObjectURL:function revokeObjectURL(){return""}}),e.window=a.g)})("undefined"==typeof a.g?null:a.g),t=t||"multi-streams-mixer";var u=[],l=!1,g=document.createElement("canvas"),m=g.getContext("2d");g.style.opacity=0,g.style.position="absolute",g.style.zIndex=-1,g.style.top="-1000em",g.style.left="-1000em",g.className=t,(document.body||document.documentElement).appendChild(g),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var p=this,h=window.AudioContext;"undefined"==typeof h&&("undefined"!=typeof webkitAudioContext&&(h=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(h=mozAudioContext));var f=window.URL;"undefined"==typeof f&&"undefined"!=typeof webkitURL&&(f=webkitURL),"undefined"!=typeof navigator&&"undefined"==typeof navigator.getUserMedia&&("undefined"!=typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!=typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var b=window.MediaStream;"undefined"==typeof b&&"undefined"!=typeof webkitMediaStream&&(b=webkitMediaStream),"undefined"!=typeof b&&"undefined"==typeof b.prototype.stop&&(b.prototype.stop=function(){this.getTracks().forEach(function(e){e.stop()})});var v={};"undefined"==typeof h?"undefined"!=typeof webkitAudioContext&&(v.AudioContext=webkitAudioContext):v.AudioContext=h,this.startDrawingFrames=function(){r()},this.appendStreams=function(t){if(!t)throw"First parameter is required.";t instanceof Array||(t=[t]),t.forEach(function(t){var a=new b;if(t.getTracks().filter(function(e){return"video"===e.kind}).length){var i=s(t);i.stream=t,u.push(i),a.addTrack(t.getTracks().filter(function(e){return"video"===e.kind})[0])}if(t.getTracks().filter(function(e){return"audio"===e.kind}).length){var r=p.audioContext.createMediaStreamSource(t);p.audioDestination=p.audioContext.createMediaStreamDestination(),r.connect(p.audioDestination),a.addTrack(p.audioDestination.stream.getTracks().filter(function(e){return"audio"===e.kind})[0])}e.push(a)})},this.releaseStreams=function(){u=[],l=!0,p.gainNode&&(p.gainNode.disconnect(),p.gainNode=null),p.audioSources.length&&(p.audioSources.forEach(function(e){e.disconnect()}),p.audioSources=[]),p.audioDestination&&(p.audioDestination.disconnect(),p.audioDestination=null),p.audioContext&&p.audioContext.close(),p.audioContext=null,m.clearRect(0,0,g.width,g.height),g.stream&&(g.stream.stop(),g.stream=null)},this.resetVideoStreams=function(e){e&&!(e instanceof Array)&&(e=[e]),c(e)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=function(){l=!1;var t=d(),a=n();a&&a.getTracks().filter(function(e){return"audio"===e.kind}).forEach(function(e){t.addTrack(e)});var i;return e.forEach(function(e){e.fullcanvas&&(i=!0)}),t}}var r,o;"undefined"==typeof RecordRTC&&(e.exports=i,r=[],o=function(){return i}.apply(t,r),!(void 0!==o&&(e.exports=o)))},212:function _(e,t,a){"use strict";var r=Math.ceil,o=Math.round,d=Math.pow,n=Math.floor,s=Math.log;function c(e,t){function a(a){return(t.disableLogs||console.log("RecordRTC version: ",v.version),!a||(t=new u(e,a)),t.disableLogs||console.log("started recording "+t.type+" stream."),b)?(b.clearRecordedData(),b.record(),h("recording"),v.recordingDuration&&g(),v):(i(function(){v.recordingDuration&&g()}),v)}function i(a){a&&(t.initCallback=function(){a(),a=t.initCallback=null});var i=new l(e,t);b=new i(e,t),b.record(),h("recording"),t.disableLogs||console.log("Initialized recorderType:",b.constructor.name,"for output-type:",t.type)}function r(e){function a(a){if(!b)return void("function"==typeof e.call?e.call(v,""):e(""));Object.keys(b).forEach(function(e){"function"==typeof b[e]||(v[e]=b[e])});var i=b.blob;if(!i)if(a)b.blob=i=a;else throw"Recording failed.";if(i&&!t.disableLogs&&console.log(i.type,"->",m(i.size)),e){var r;try{r=O.createObjectURL(i)}catch(t){}"function"==typeof e.call?e.call(v,r):e(r)}t.autoWriteToDisk&&s(function(e){var a={};a[t.type+"Blob"]=e,W.Store(a)})}return e=e||function(){},b?"paused"===v.state?(v.resumeRecording(),void setTimeout(function(){r(e)},1)):void("recording"!==v.state&&!t.disableLogs&&console.warn("Recording state should be: \"recording\", however current state is: ",v.state),!t.disableLogs&&console.log("Stopped recording "+t.type+" stream."),"gif"===t.type?(b.stop(),a()):b.stop(a),h("stopped")):void f()}function o(){return b?"recording"===v.state?void(h("paused"),b.pause(),!t.disableLogs&&console.log("Paused recording.")):void(t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",v.state)):void f()}function d(){return b?"paused"===v.state?void(h("recording"),b.resume(),!t.disableLogs&&console.log("Resumed recording.")):void(t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",v.state)):void f()}function n(e){postMessage(new FileReaderSync().readAsDataURL(e))}function s(e,a){function i(e){try{var t=O.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),a=new Worker(t);return O.revokeObjectURL(t),a}catch(t){}}if(!e)throw"Pass a callback function over getDataURL.";var r=a?a.blob:(b||{}).blob;if(!r)return t.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout(function(){s(e,a)},1e3);if("undefined"!=typeof Worker&&!navigator.mozGetUserMedia){var o=i(n);o.onmessage=function(t){e(t.data)},o.postMessage(r)}else{var d=new FileReader;d.readAsDataURL(r),d.onload=function(t){e(t.target.result)}}}function g(e){return e=e||0,"paused"===v.state?void setTimeout(function(){g(e)},1e3):"stopped"===v.state?void 0:e>=v.recordingDuration?void r(v.onRecordingStopped):void(e+=1e3,setTimeout(function(){g(e)},1e3))}function h(e){v&&(v.state=e,"function"==typeof v.onStateChanged.call?v.onStateChanged.call(v,e):v.onStateChanged(e))}function f(){!0===t.disableLogs||console.warn(R)}if(!e)throw"First parameter is required.";t=t||{type:"video"},t=new u(e,t);var b,v=this,R="It seems that recorder is destroyed or \"startRecording\" is not invoked for "+t.type+" recorder.",S={startRecording:a,stopRecording:r,pauseRecording:o,resumeRecording:d,initRecorder:i,setRecordingDuration:function setRecordingDuration(e,t){if("undefined"==typeof e)throw"recordingDuration is required.";if("number"!=typeof e)throw"recordingDuration must be a number.";return v.recordingDuration=e,v.onRecordingStopped=t||function(){},{onRecordingStopped:function onRecordingStopped(e){v.onRecordingStopped=e}}},clearRecordedData:function clearRecordedData(){return b?void(b.clearRecordedData(),!t.disableLogs&&console.log("Cleared old recorded data.")):void f()},getBlob:function getBlob(){return b?b.blob:void f()},getDataURL:s,toURL:function toURL(){return b?O.createObjectURL(b.blob):void f()},getInternalRecorder:function getInternalRecorder(){return b},save:function save(e){return b?void p(b.blob,e):void f()},getFromDisk:function getFromDisk(e){return b?void c.getFromDisk(t.type,e):void f()},setAdvertisementArray:function setAdvertisementArray(e){t.advertisement=[];for(var a=e.length,r=0;r<a;r++)t.advertisement.push({duration:r,image:e[r]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function reset(){"recording"!==v.state||t.disableLogs||console.warn("Stop an active recorder."),b&&"function"==typeof b.clearRecordedData&&b.clearRecordedData(),b=null,h("inactive"),v.blob=null},onStateChanged:function onStateChanged(e){t.disableLogs||console.log("Recorder state changed:",e)},state:"inactive",getState:function getState(){return v.state},destroy:function destroy(){var e=t.disableLogs;t={disableLogs:!0},v.reset(),h("destroyed"),S=v=null,z.AudioContextConstructor&&(z.AudioContextConstructor.close(),z.AudioContextConstructor=null),t.disableLogs=e,t.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return v=S,S;for(var w in S)this[w]=S[w];return v=this,S}function u(e,t){return t.recorderType||t.type||(t.audio&&t.video?t.type="video":!!t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===y||t.recorderType===w||"undefined"!=typeof L&&t.recorderType===L?t.type="video":t.recorderType===k?t.type="gif":t.recorderType===S?t.type="audio":t.recorderType===R&&(f(e,"audio").length&&f(e,"video").length?t.type="video":!f(e,"audio").length&&f(e,"video").length?t.type="video":f(e,"audio").length&&!f(e,"video").length&&(t.type="audio"))),"undefined"!=typeof R&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(!t.mimeType&&(t.mimeType="video/webm"),!t.type&&(t.type=t.mimeType.split("/")[0]),!t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),!t.type&&(t.type="audio")),t}function l(e,t){var a;return(P||I||B)&&(a=S),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!P&&(a=R),"video"===t.type&&(P||B)&&(a=y,"undefined"!=typeof L&&"undefined"!=typeof ReadableStream&&(a=L)),"gif"===t.type&&(a=k),"canvas"===t.type&&(a=w),v()&&a!==w&&a!==k&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(f(e,"video").length||f(e,"audio").length)&&("audio"===t.type?"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(a=R):"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(a=R)),e instanceof Array&&e.length&&(a=T),t.recorderType&&(a=t.recorderType),t.disableLogs||!a||!a.name||console.log("Using recorderType:",a.name||a.constructor.name),!a&&N&&(a=R),a}function g(e){this.addStream=function(t){t&&(e=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t,a=this.mediaType,i=this.mimeType||{audio:null,video:null,gif:null};if("function"!=typeof a.audio&&v()&&!f(e,"audio").length&&(a.audio=!1),"function"!=typeof a.video&&v()&&!f(e,"video").length&&(a.video=!1),"function"!=typeof a.gif&&v()&&!f(e,"video").length&&(a.gif=!1),!a.audio&&!a.video&&!a.gif)throw"MediaStream must have either audio or video tracks.";if(!a.audio||(t=null,"function"==typeof a.audio&&(t=a.audio),this.audioRecorder=new c(e,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:t,mimeType:i.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),!a.video&&this.audioRecorder.startRecording()),!!a.video){t=null,"function"==typeof a.video&&(t=a.video);var r=e;if(v()&&!!a.audio&&"function"==typeof a.audio){var o=f(e,"video")[0];j?(r=new F,r.addTrack(o),t&&t===y&&(t=R)):(r=new F,r.addTrack(o))}this.videoRecorder=new c(r,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:t,mimeType:i.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),a.audio||this.videoRecorder.startRecording()}if(!!a.audio&&!!a.video){var d=this,n=!0===v();a.audio instanceof S&&!!a.video?n=!1:!0!==a.audio&&!0!==a.video&&a.audio!==a.video&&(n=!1),!0===n?(d.audioRecorder=null,d.videoRecorder.startRecording()):d.videoRecorder.initRecorder(function(){d.audioRecorder.initRecorder(function(){d.videoRecorder.startRecording(),d.audioRecorder.startRecording()})})}!a.gif||(t=null,"function"==typeof a.gif&&(t=a.gif),this.gifRecorder=new c(e,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:t,mimeType:i.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(t){e(t,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(t){e(t,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(t){e(t,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){function t(e,t){if("undefined"!=typeof Worker){var i=a(function(e){postMessage(new FileReaderSync().readAsDataURL(e))});i.onmessage=function(e){t(e.data)},i.postMessage(e)}else{var r=new FileReader;r.readAsDataURL(e),r.onload=function(e){t(e.target.result)}}}function a(e){var t,a=O.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),i=new Worker(a);if("undefined"!=typeof O)t=O;else if("undefined"!=typeof webkitURL)t=webkitURL;else throw"Neither URL nor webkitURL detected.";return t.revokeObjectURL(a),i}this.getBlob(function(a){a.audio&&a.video?t(a.audio,function(i){t(a.video,function(t){e({audio:i,video:t})})}):a.audio?t(a.audio,function(t){e({audio:t})}):a.video&&t(a.video,function(t){e({video:t})})})},this.writeToDisk=function(){c.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},!!e.audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof e.audio?e.audio:""),!!e.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof e.video?e.video:""),!!e.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof e.gif?e.gif:"")}}function m(e){if(0===e)return"0 Bytes";var t=parseInt(n(s(e)/s(1000)),10);return(e/d(1000,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}function p(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(t){}var a=(e.type||"video/webm").split("/")[1];if(-1!==a.indexOf(";")&&(a=a.split(";")[0]),t&&-1!==t.indexOf(".")){var i=t.split(".");t=i[0],a=i[1]}var r=(t||o(9999999999*Math.random())+888888888)+"."+a;if("undefined"!=typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,r);if("undefined"!=typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,r);var d=document.createElement("a");d.href=O.createObjectURL(e),d.download=r,d.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(d),"function"==typeof d.click?d.click():(d.target="_blank",d.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),O.revokeObjectURL(d.href)}function h(){return"undefined"!=typeof window&&"object"===_typeof(window.process)&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"===_typeof(process.versions)&&process.versions.electron||!!("object"===("undefined"==typeof navigator?"undefined":_typeof(navigator))&&"string"==typeof navigator.userAgent&&0<=navigator.userAgent.indexOf("Electron"))}function f(e,a){return e&&e.getTracks?e.getTracks().filter(function(e){return e.kind===(a||"audio")}):[]}function b(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}function v(){if(j||N||I)return!0;var e,t,a=navigator.appVersion,i=navigator.userAgent,r=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10);return(P||B)&&(e=i.indexOf("Chrome"),r=i.substring(e+7)),-1!==(t=r.indexOf(";"))&&(r=r.substring(0,t)),-1!==(t=r.indexOf(" "))&&(r=r.substring(0,t)),o=parseInt(""+r,10),isNaN(o)&&(r=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10)),49<=o}function R(t,a){function i(){n.timestamps.push(new Date().getTime()),"function"==typeof a.onTimeStamp&&a.onTimeStamp(n.timestamps[n.timestamps.length-1],n.timestamps)}function r(e){return u&&u.mimeType?u.mimeType:e.mimeType||"video/webm"}function o(){c=[],u=null,n.timestamps=[]}function d(){if("active"in t){if(!t.active)return!1;}else if("ended"in t&&t.ended)return!1;return!0}var n=this;if("undefined"==typeof t)throw"First argument \"MediaStream\" is required.";if("undefined"==typeof MediaRecorder)throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(a=a||{mimeType:"video/webm"},"audio"===a.type){if(f(t,"video").length&&f(t,"audio").length){var s;navigator.mozGetUserMedia?(s=new F,s.addTrack(f(t,"audio")[0])):s=new F(f(t,"audio")),t=s}a.mimeType&&-1!==a.mimeType.toString().toLowerCase().indexOf("audio")||(a.mimeType=P?"audio/webm":"audio/ogg"),a.mimeType&&"audio/ogg"!==a.mimeType.toString().toLowerCase()&&!!navigator.mozGetUserMedia&&(a.mimeType="audio/ogg")}var c=[];this.getArrayOfBlobs=function(){return c},this.record=function(){n.blob=null,n.clearRecordedData(),n.timestamps=[],l=[],c=[];var o=a;a.disableLogs||console.log("Passing following config over MediaRecorder API.",o),u&&(u=null),P&&!v()&&(o="video/vp8"),"function"==typeof MediaRecorder.isTypeSupported&&o.mimeType&&!MediaRecorder.isTypeSupported(o.mimeType)&&(!a.disableLogs&&console.warn("MediaRecorder API seems unable to record mimeType:",o.mimeType),o.mimeType="audio"===a.type?"audio/webm":"video/webm");try{u=new MediaRecorder(t,o),a.mimeType=o.mimeType}catch(a){u=new MediaRecorder(t)}o.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in u&&!1===u.canRecordMimeType(o.mimeType)&&!a.disableLogs&&console.warn("MediaRecorder API seems unable to record mimeType:",o.mimeType),u.ondataavailable=function(t){if(t.data&&l.push("ondataavailable: "+m(t.data.size)),"number"==typeof a.timeSlice){if(t.data&&t.data.size&&(c.push(t.data),i(),"function"==typeof a.ondataavailable)){var e=a.getNativeBlob?t.data:new Blob([t.data],{type:r(o)});a.ondataavailable(e)}return}return!t.data||!t.data.size||100>t.data.size||n.blob?void(n.recordingCallback&&(n.recordingCallback(new Blob([],{type:r(o)})),n.recordingCallback=null)):void(n.blob=a.getNativeBlob?t.data:new Blob([t.data],{type:r(o)}),n.recordingCallback&&(n.recordingCallback(n.blob),n.recordingCallback=null))},u.onstart=function(){l.push("started")},u.onpause=function(){l.push("paused")},u.onresume=function(){l.push("resumed")},u.onstop=function(){l.push("stopped")},u.onerror=function(e){e&&(!e.name&&(e.name="UnknownError"),l.push("error: "+e),!a.disableLogs&&(-1===e.name.toString().toLowerCase().indexOf("invalidstate")?-1===e.name.toString().toLowerCase().indexOf("notsupported")?-1===e.name.toString().toLowerCase().indexOf("security")?"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e):console.error("MediaRecorder security error",e):console.error("MIME type (",o.mimeType,") is not supported.",e):console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",e)),function(e){return!n.manuallyStopped&&u&&"inactive"===u.state?(delete a.timeslice,void u.start(600000)):void setTimeout(e,1e3)}(),"inactive"!==u.state&&"stopped"!==u.state&&u.stop())},"number"==typeof a.timeSlice?(i(),u.start(a.timeSlice)):u.start(36e5),a.initCallback&&a.initCallback()},this.timestamps=[],this.stop=function(e){e=e||function(){},n.manuallyStopped=!0,u&&(this.recordingCallback=e,"recording"===u.state&&u.stop(),"number"==typeof a.timeSlice&&setTimeout(function(){n.blob=new Blob(c,{type:r(a)}),n.recordingCallback(n.blob)},100))},this.pause=function(){u&&("recording"!==u.state||u.pause())},this.resume=function(){u&&("paused"!==u.state||u.resume())},this.clearRecordedData=function(){u&&"recording"===u.state&&n.stop(o),o()};var u;this.getInternalRecorder=function(){return u},this.blob=null,this.getState=function(){return u?u.state||"inactive":"inactive"};var l=[];this.getAllStates=function(){return l},"undefined"==typeof a.checkForInactiveTracks&&(a.checkForInactiveTracks=!1);var n=this;(function e(){return u&&!1!==a.checkForInactiveTracks?!1===d()?(a.disableLogs||console.log("MediaStream seems stopped."),void n.stop()):void setTimeout(e,1e3):void 0})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}function S(e,t){function a(){if(!1===t.checkForInactiveTracks)return!0;if("active"in e){if(!e.active)return!1;}else if("ended"in e&&e.ended)return!1;return!0}function i(e,t){function a(e,t){function a(e,t,a){var s=o(e.length*(t/a)),c=[],u=+((e.length-1)/(s-1));c[0]=e[0];for(var l=1;l<s-1;l++){var g=l*u,m=(+n(g)).toFixed(),p=(+r(g)).toFixed();c[l]=d(e[m],e[p],g-m)}return c[s-1]=e[e.length-1],c}function d(e,t,a){return e+(t-e)*a}function s(e,t){for(var a,r=new Float64Array(t),o=0,d=e.length,n=0;n<d;n++)a=e[n],r.set(a,o),o+=a.length;return r}function c(e,t){for(var a=e.length+t.length,i=new Float64Array(a),r=0,o=0;o<a;)i[o++]=e[r],i[o++]=t[r],r++;return i}function u(e,t,a){for(var r=a.length,o=0;o<r;o++)e.setUint8(t+o,a.charCodeAt(o))}var l=e.numberOfAudioChannels,g=e.leftBuffers.slice(0),m=e.rightBuffers.slice(0),p=e.sampleRate,h=e.internalInterleavedLength,f=e.desiredSampRate;2===l&&(g=s(g,h),m=s(m,h),f&&(g=a(g,f,p),m=a(m,f,p))),1===l&&(g=s(g,h),f&&(g=a(g,f,p))),f&&(p=f);var b;2===l&&(b=c(g,m)),1===l&&(b=g);var v=b.length,R=new ArrayBuffer(44+2*v),S=new DataView(R);u(S,0,"RIFF"),S.setUint32(4,36+2*v,!0),u(S,8,"WAVE"),u(S,12,"fmt "),S.setUint32(16,16,!0),S.setUint16(20,1,!0),S.setUint16(22,l,!0),S.setUint32(24,p,!0),S.setUint32(28,2*(p*l),!0),S.setUint16(32,2*l,!0),S.setUint16(34,16,!0),u(S,36,"data"),S.setUint32(40,2*v,!0);for(var w=44,y=0;y<v;y++)S.setInt16(w,b[y]*(32767*1),!0),w+=2;return t?t({buffer:R,view:S}):void postMessage({buffer:R,view:S})}if(e.noWorker)return void a(e,function(e){t(e.buffer,e.view)});var i=d(a);i.onmessage=function(e){t(e.data.buffer,e.data.view),O.revokeObjectURL(i.workerURL),i.terminate()},i.postMessage(e)}function d(e){var t=O.createObjectURL(new Blob([e.toString(),";this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),a=new Worker(t);return a.workerURL=t,a}function s(){h=[],b=[],R=0,D=!1,v=!1,x=!1,y=null,p.leftchannel=h,p.rightchannel=b,p.numberOfAudioChannels=S,p.desiredSampRate=w,p.sampleRate=L,p.recordingLength=R,M={left:[],right:[],recordingLength:0}}function u(){m&&(m.onaudioprocess=null,m.disconnect(),m=null),k&&(k.disconnect(),k=null),s()}function l(i){if(!x){if(!1===a()&&(!t.disableLogs&&console.log("MediaStream seems stopped."),m.disconnect(),v=!1),!v)return void(k&&(k.disconnect(),k=null));D||(D=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var e=i.inputBuffer.getChannelData(0),r=new Float32Array(e);if(h.push(r),2===S){var o=i.inputBuffer.getChannelData(1),d=new Float32Array(o);b.push(d)}R+=T,p.recordingLength=R,"undefined"!=typeof t.timeSlice&&(M.recordingLength+=T,M.left.push(r),2===S&&M.right.push(d))}}function g(){v&&"function"==typeof t.ondataavailable&&"undefined"!=typeof t.timeSlice&&(M.left.length?(i({desiredSampRate:w,sampleRate:L,numberOfAudioChannels:S,internalInterleavedLength:M.recordingLength,leftBuffers:M.left,rightBuffers:1===S?[]:M.right},function(e,a){var i=new Blob([a],{type:"audio/wav"});t.ondataavailable(i),setTimeout(g,t.timeSlice)}),M={left:[],right:[],recordingLength:0}):setTimeout(g,t.timeSlice))}if(!f(e,"audio").length)throw"Your stream has no audio tracks.";t=t||{};var m,p=this,h=[],b=[],v=!1,R=0,S=2,w=t.desiredSampRate;!0===t.leftChannel&&(S=1),1===t.numberOfAudioChannels&&(S=1),(!S||1>S)&&(S=2),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+S),"undefined"==typeof t.checkForInactiveTracks&&(t.checkForInactiveTracks=!0),this.record=function(){if(!1===a())throw"Please make sure MediaStream is active.";s(),D=x=!1,v=!0,"undefined"!=typeof t.timeSlice&&g()},this.stop=function(e){e=e||function(){},v=!1,i({desiredSampRate:w,sampleRate:L,numberOfAudioChannels:S,internalInterleavedLength:R,leftBuffers:h,rightBuffers:1===S?[]:b,noWorker:t.noWorker},function(t,a){p.blob=new Blob([a],{type:"audio/wav"}),p.buffer=new ArrayBuffer(a.buffer.byteLength),p.view=a,p.sampleRate=w||L,p.bufferSize=T,p.length=R,D=!1,e&&e(p.blob)})},"undefined"==typeof c.Storage&&(c.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),c.Storage.AudioContextConstructor&&"closed"!==c.Storage.AudioContextConstructor.state||(c.Storage.AudioContextConstructor=new c.Storage.AudioContext);var y=c.Storage.AudioContextConstructor,k=y.createMediaStreamSource(e),C=[0,256,512,1024,2048,4096,8192,16384],T="undefined"==typeof t.bufferSize?4096:t.bufferSize;if(-1!==C.indexOf(T)||t.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(C,null,"\t")),y.createJavaScriptNode)m=y.createJavaScriptNode(T,S,S);else if(y.createScriptProcessor)m=y.createScriptProcessor(T,S,S);else throw"WebAudio API has no support on this browser.";k.connect(m),t.bufferSize||(T=m.bufferSize);var L="undefined"==typeof t.sampleRate?y.sampleRate||44100:t.sampleRate;(22050>L||96e3<L)&&!t.disableLogs&&console.log("sample-rate must be under range 22050 and 96000."),!t.disableLogs&&t.desiredSampRate&&console.log("Desired sample-rate: "+t.desiredSampRate);var x=!1;this.pause=function(){x=!0},this.resume=function(){if(!1===a())throw"Please make sure MediaStream is active.";return v?void(x=!1):(t.disableLogs||console.log("Seems recording has been restarted."),void this.record())},this.clearRecordedData=function(){t.checkForInactiveTracks=!1,v&&this.stop(u),u()},this.name="StereoAudioRecorder",this.toString=function(){return this.name};var D=!1;m.onaudioprocess=l,y.createMediaStreamDestination?m.connect(y.createMediaStreamDestination()):m.connect(y.destination),this.leftchannel=h,this.rightchannel=b,this.numberOfAudioChannels=S,this.desiredSampRate=w,this.sampleRate=L,p.recordingLength=R;var M={left:[],right:[],recordingLength:0}}function w(e,t){function a(){p.frames=[],l=!1,g=!1}function i(){var t=document.createElement("canvas"),a=t.getContext("2d");return t.width=e.width,t.height=e.height,a.drawImage(e,0,0),t}function r(){if(g)return m=new Date().getTime(),setTimeout(r,500);if("canvas"===e.nodeName.toLowerCase()){var a=new Date().getTime()-m;return m=new Date().getTime(),p.frames.push({image:i(),duration:a}),void(l&&setTimeout(r,t.frameInterval))}html2canvas(e,{grabMouse:"undefined"==typeof t.showMousePointer||t.showMousePointer,onrendered:function onrendered(e){var a=new Date().getTime()-m;return a?void(m=new Date().getTime(),p.frames.push({image:e.toDataURL("image/webp",1),duration:a}),l&&setTimeout(r,t.frameInterval)):setTimeout(r,t.frameInterval)}})}if("undefined"==typeof html2canvas)throw"Please link: https://www.webrtc-experiment.com/screenshot.js";t=t||{},t.frameInterval||(t.frameInterval=10);var o=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){e in document.createElement("canvas")&&(o=!0)});var d=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,n=50,s=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);d&&s&&s[2]&&(n=parseInt(s[2],10)),d&&52>n&&(o=!1),t.useWhammyRecorder&&(o=!1);var c,u;if(!o)!navigator.mozGetUserMedia||t.disableLogs||console.error("Canvas recording is NOT supported in Firefox.");else if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),e instanceof HTMLCanvasElement)c=e;else if(e instanceof CanvasRenderingContext2D)c=e.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";var l;this.record=function(){if(l=!0,o&&!t.useWhammyRecorder){var e;"captureStream"in c?e=c.captureStream(25):"mozCaptureStream"in c?e=c.mozCaptureStream(25):"webkitCaptureStream"in c&&(e=c.webkitCaptureStream(25));try{var a=new F;a.addTrack(f(e,"video")[0]),e=a}catch(t){}if(!e)throw"captureStream API are NOT available.";u=new R(e,{mimeType:t.mimeType||"video/webm"}),u.record()}else p.frames=[],m=new Date().getTime(),r();t.initCallback&&t.initCallback()},this.getWebPImages=function(a){if("canvas"!==e.nodeName.toLowerCase())return void a();var i=p.frames.length;p.frames.forEach(function(e,a){var r=i-a;t.disableLogs||console.log(r+"/"+i+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(r,i);var o=e.image.toDataURL("image/webp",1);p.frames[a].image=o}),t.disableLogs||console.log("Generating WebM"),a()},this.stop=function(e){l=!1;var a=this;return o&&u?void u.stop(e):void this.getWebPImages(function(){p.compile(function(i){t.disableLogs||console.log("Recording finished!"),a.blob=i,a.blob.forEach&&(a.blob=new Blob([],{type:"video/webm"})),e&&e(a.blob),p.frames=[]})})};var g=!1;this.pause=function(){if(g=!0,u instanceof R)return void u.pause()},this.resume=function(){return g=!1,u instanceof R?void u.resume():void(!l&&this.record())},this.clearRecordedData=function(){l&&this.stop(a),a()},this.name="CanvasRecorder",this.toString=function(){return this.name};var m=new Date().getTime(),p=new G.Video(100)}function y(e,t){function a(e){e="undefined"==typeof e?10:e;var t=new Date().getTime()-u;return t?s?(u=new Date().getTime(),setTimeout(a,100)):void(u=new Date().getTime(),c.paused&&c.play(),m.drawImage(c,0,0,g.width,g.height),l.frames.push({duration:t,image:g.toDataURL("image/webp")}),!n&&setTimeout(a,e,e)):setTimeout(a,e,e)}function i(e){var t=-1,a=e.length;(function i(){return t++,t===a?void e.callback():void setTimeout(function(){e.functionToLoop(i,t)},1)})()}function r(e,t,a,r,o){var n=Math.sqrt,s=document.createElement("canvas");s.width=g.width,s.height=g.height;var c=s.getContext("2d"),u=[],l=t&&0<t&&t<=e.length?t:e.length,m={r:0,g:0,b:0},p=n(d(255,2)+d(255,2)+d(255,2)),h=a&&0<=a&&1>=a?a:0,b=r&&0<=r&&1>=r?r:0,v=!1;i({length:l,functionToLoop:function functionToLoop(a,i){var r,o,s,l=function(){!v&&s-r<=s*b||(-1===t&&(v=!0),u.push(e[i])),a()};if(!v){var f=new Image;f.onload=function(){c.drawImage(f,0,0,g.width,g.height);var e=c.getImageData(0,0,g.width,g.height);r=0,o=e.data.length,s=e.data.length/4;for(var t=0;t<o;t+=4){var a={r:e.data[t],g:e.data[t+1],b:e.data[t+2]},i=n(d(a.r-m.r,2)+d(a.g-m.g,2)+d(a.b-m.b,2));i<=p*h&&r++}l()},f.src=e[i].image}else l()},callback:function callback(){u=u.concat(e.slice(l)),0>=u.length&&u.push(e[e.length-1]),o(u)}})}function o(){l.frames=[],n=!0,s=!1}t=t||{},t.frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),g.width=t.canvas.width||320,g.height=t.canvas.height||240,m=g.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(c=t.video.cloneNode(),t.initCallback&&t.initCallback()):(c=document.createElement("video"),b(e,c),c.onloadedmetadata=function(){t.initCallback&&t.initCallback()},c.width=t.video.width,c.height=t.video.height),c.muted=!0,c.play(),u=new Date().getTime(),l=new G.Video,t.disableLogs||(console.log("canvas resolutions",g.width,"*",g.height),console.log("video width/height",c.width||g.width,"*",c.height||g.height)),a(t.frameInterval)};var n=!1;this.stop=function(e){e=e||function(){},n=!0;var a=this;setTimeout(function(){r(l.frames,-1,null,null,function(i){l.frames=i,t.advertisement&&t.advertisement.length&&(l.frames=t.advertisement.concat(l.frames)),l.compile(function(t){a.blob=t,a.blob.forEach&&(a.blob=new Blob([],{type:"video/webm"})),e&&e(a.blob)})})},10)};var s=!1;this.pause=function(){s=!0},this.resume=function(){s=!1,n&&this.record()},this.clearRecordedData=function(){n||this.stop(o),o()},this.name="WhammyRecorder",this.toString=function(){return this.name};var c,u,l,g=document.createElement("canvas"),m=g.getContext("2d")}function k(e,t){function a(){m&&(m.stream().bin=[])}if("undefined"==typeof GIFEncoder){var i=document.createElement("script");i.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(i)}t=t||{};var r=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement;this.record=function(){function e(a){if(!0!==h.clearedRecordedData){if(o)return setTimeout(function(){e(a)},100);p=M(e),void 0===_typeof(g)&&(g=a),90>a-g||(!r&&c.paused&&c.play(),!r&&n.drawImage(c,0,0,d.width,d.height),t.onGifPreview&&t.onGifPreview(d.toDataURL("image/png")),m.addFrame(n),g=a)}}return"undefined"==typeof GIFEncoder?void setTimeout(h.record,1e3):s?void(!r&&(!t.width&&(t.width=c.offsetWidth||320),!t.height&&(t.height=c.offsetHeight||240),!t.video&&(t.video={width:t.width,height:t.height}),!t.canvas&&(t.canvas={width:t.width,height:t.height}),d.width=t.canvas.width||320,d.height=t.canvas.height||240,c.width=t.video.width||320,c.height=t.video.height||240),m=new GIFEncoder,m.setRepeat(0),m.setDelay(t.frameRate||200),m.setQuality(t.quality||10),m.start(),"function"==typeof t.onGifRecordingStarted&&t.onGifRecordingStarted(),u=Date.now(),p=M(e),t.initCallback&&t.initCallback()):void setTimeout(h.record,1e3)},this.stop=function(e){e=e||function(){},p&&A(p),l=Date.now(),this.blob=new Blob([new Uint8Array(m.stream().bin)],{type:"image/gif"}),e(this.blob),m.stream().bin=[]};var o=!1;this.pause=function(){o=!0},this.resume=function(){o=!1},this.clearRecordedData=function(){h.clearedRecordedData=!0,a()},this.name="GifRecorder",this.toString=function(){return this.name};var d=document.createElement("canvas"),n=d.getContext("2d");r&&(e instanceof CanvasRenderingContext2D?(n=e,d=n.canvas):e instanceof HTMLCanvasElement&&(n=e.getContext("2d"),d=e));var s=!0;if(!r){var c=document.createElement("video");c.muted=!0,c.autoplay=!0,c.playsInline=!0,s=!1,c.onloadedmetadata=function(){s=!0},b(e,c),c.play()}var u,l,g,m,p=null,h=this}function C(e,t){function i(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}function r(){if(!g){var e=l.length,t=!1,a=[];if(l.forEach(function(e){e.stream||(e.stream={}),e.stream.fullcanvas?t=e:a.push(e)}),t)m.width=t.stream.width,m.height=t.stream.height;else if(a.length){m.width=1<e?2*a[0].width:a[0].width;var i=1;(3===e||4===e)&&(i=2),(5===e||6===e)&&(i=3),(7===e||8===e)&&(i=4),(9===e||10===e)&&(i=5),m.height=a[0].height*i}else m.width=h.width||360,m.height=h.height||240;t&&t instanceof HTMLVideoElement&&o(t),a.forEach(function(e,t){o(e,t)}),setTimeout(r,h.frameInterval)}}function o(e,t){if(!g){var a=0,i=0,r=e.width,o=e.height;1===t&&(a=e.width),2===t&&(i=e.height),3===t&&(a=e.width,i=e.height),4===t&&(i=2*e.height),5===t&&(a=e.width,i=2*e.height),6===t&&(i=3*e.height),7===t&&(a=e.width,i=3*e.height),"undefined"!=typeof e.stream.left&&(a=e.stream.left),"undefined"!=typeof e.stream.top&&(i=e.stream.top),"undefined"!=typeof e.stream.width&&(r=e.stream.width),"undefined"!=typeof e.stream.height&&(o=e.stream.height),p.drawImage(e,a,i,r,o),"function"==typeof e.stream.onRender&&e.stream.onRender(p,a,i,r,o,t)}}function d(){u();var e;"captureStream"in m?e=m.captureStream():"mozCaptureStream"in m?e=m.mozCaptureStream():!h.disableLogs&&console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var t=new v;return e.getTracks().filter(function(e){return"video"===e.kind}).forEach(function(e){t.addTrack(e)}),m.stream=t,t}function n(){R.AudioContextConstructor||(R.AudioContextConstructor=new R.AudioContext),h.audioContext=R.AudioContextConstructor,h.audioSources=[],!0===h.useGainNode&&(h.gainNode=h.audioContext.createGain(),h.gainNode.connect(h.audioContext.destination),h.gainNode.gain.value=0);var t=0;if(e.forEach(function(e){if(e.getTracks().filter(function(e){return"audio"===e.kind}).length){t++;var a=h.audioContext.createMediaStreamSource(e);!0===h.useGainNode&&a.connect(h.gainNode),h.audioSources.push(a)}}),!!t)return h.audioDestination=h.audioContext.createMediaStreamDestination(),h.audioSources.forEach(function(e){e.connect(h.audioDestination)}),h.audioDestination.stream}function s(e){var a=document.createElement("video");return i(e,a),a.className=t,a.muted=!0,a.volume=0,a.width=e.width||h.width||360,a.height=e.height||h.height||240,a.play(),a}function u(t){l=[],t=t||e,t.forEach(function(e){if(e.getTracks().filter(function(e){return"video"===e.kind}).length){var t=s(e);t.stream=e,l.push(t)}})}(function(e){"undefined"==typeof c&&e&&"undefined"==typeof window&&"undefined"!=typeof a.g&&(a.g.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function getUserMedia(){}},!a.g.console&&(a.g.console={}),("undefined"==typeof a.g.console.log||"undefined"==typeof a.g.console.error)&&(a.g.console.error=a.g.console.log=a.g.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(e.document={documentElement:{appendChild:function appendChild(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function getContext(){return e},play:function play(){},pause:function pause(){},drawImage:function(){},toDataURL:function toDataURL(){return""},style:{}};return e},e.HTMLVideoElement=function(){}),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}),"undefined"==typeof b&&(e.URL={createObjectURL:function createObjectURL(){return""},revokeObjectURL:function revokeObjectURL(){return""}}),e.window=a.g)})("undefined"==typeof a.g?null:a.g),t=t||"multi-streams-mixer";var l=[],g=!1,m=document.createElement("canvas"),p=m.getContext("2d");m.style.opacity=0,m.style.position="absolute",m.style.zIndex=-1,m.style.top="-1000em",m.style.left="-1000em",m.className=t,(document.body||document.documentElement).appendChild(m),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var h=this,f=window.AudioContext;"undefined"==typeof f&&("undefined"!=typeof webkitAudioContext&&(f=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(f=mozAudioContext));var b=window.URL;"undefined"==typeof b&&"undefined"!=typeof webkitURL&&(b=webkitURL),"undefined"!=typeof navigator&&"undefined"==typeof navigator.getUserMedia&&("undefined"!=typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!=typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var v=window.MediaStream;"undefined"==typeof v&&"undefined"!=typeof webkitMediaStream&&(v=webkitMediaStream),"undefined"!=typeof v&&"undefined"==typeof v.prototype.stop&&(v.prototype.stop=function(){this.getTracks().forEach(function(e){e.stop()})});var R={};"undefined"==typeof f?"undefined"!=typeof webkitAudioContext&&(R.AudioContext=webkitAudioContext):R.AudioContext=f,this.startDrawingFrames=function(){r()},this.appendStreams=function(t){if(!t)throw"First parameter is required.";t instanceof Array||(t=[t]),t.forEach(function(t){var a=new v;if(t.getTracks().filter(function(e){return"video"===e.kind}).length){var i=s(t);i.stream=t,l.push(i),a.addTrack(t.getTracks().filter(function(e){return"video"===e.kind})[0])}if(t.getTracks().filter(function(e){return"audio"===e.kind}).length){var r=h.audioContext.createMediaStreamSource(t);h.audioDestination=h.audioContext.createMediaStreamDestination(),r.connect(h.audioDestination),a.addTrack(h.audioDestination.stream.getTracks().filter(function(e){return"audio"===e.kind})[0])}e.push(a)})},this.releaseStreams=function(){l=[],g=!0,h.gainNode&&(h.gainNode.disconnect(),h.gainNode=null),h.audioSources.length&&(h.audioSources.forEach(function(e){e.disconnect()}),h.audioSources=[]),h.audioDestination&&(h.audioDestination.disconnect(),h.audioDestination=null),h.audioContext&&h.audioContext.close(),h.audioContext=null,p.clearRect(0,0,m.width,m.height),m.stream&&(m.stream.stop(),m.stream=null)},this.resetVideoStreams=function(e){e&&!(e instanceof Array)&&(e=[e]),u(e)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=function(){g=!1;var t=d(),a=n();a&&a.getTracks().filter(function(e){return"audio"===e.kind}).forEach(function(e){t.addTrack(e)});var i;return e.forEach(function(e){e.fullcanvas&&(i=!0)}),t}}function T(e,t){function a(){var t=[];return e.forEach(function(e){f(e,"video").forEach(function(e){t.push(e)})}),t}e=e||[];var i,r,o=this;t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},t.frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){i=new C(e,t.elementClass||"multi-streams-mixer"),a().length&&(i.frameInterval=t.frameInterval||10,i.width=t.video.width||360,i.height=t.video.height||240,i.startDrawingFrames()),t.previewStream&&"function"==typeof t.previewStream&&t.previewStream(i.getMixedStream()),r=new R(i.getMixedStream(),t),r.record()},this.stop=function(e){r&&r.stop(function(t){o.blob=t,e(t),o.clearRecordedData()})},this.pause=function(){r&&r.pause()},this.resume=function(){r&&r.resume()},this.clearRecordedData=function(){r&&(r.clearRecordedData(),r=null),i&&(i.releaseStreams(),i=null)},this.addStreams=function(a){if(!a)throw"First parameter is required.";a instanceof Array||(a=[a]),e.concat(a),r&&i&&(i.appendStreams(a),t.previewStream&&"function"==typeof t.previewStream&&t.previewStream(i.getMixedStream()))},this.resetVideoStreams=function(e){i&&(e&&!(e instanceof Array)&&(e=[e]),i.resetVideoStreams(e))},this.getMixer=function(){return i},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}function L(e,t){function a(){return new ReadableStream({start:function start(a){var i=document.createElement("canvas"),r=document.createElement("video"),d=!0;r.srcObject=e,r.muted=!0,r.height=t.height,r.width=t.width,r.volume=0,r.onplaying=function(){i.width=t.width,i.height=t.height;var e=i.getContext("2d"),n=1e3/t.frameRate,s=setInterval(function(){if(o&&(clearInterval(s),a.close()),d&&(d=!1,t.onVideoProcessStarted&&t.onVideoProcessStarted()),e.drawImage(r,0,0),"closed"!==a._controlledReadableStream.state)try{a.enqueue(e.getImageData(0,0,t.width,t.height))}catch(t){}},n)},r.play()}})}function i(e,r){if(!t.workerPath&&!r)return o=!1,void fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(t){t.arrayBuffer().then(function(t){i(e,t)})});if(!t.workerPath&&r instanceof ArrayBuffer){var c=new Blob([r],{type:"text/javascript"});t.workerPath=O.createObjectURL(c)}t.workerPath||console.error("workerPath parameter is missing."),d=new Worker(t.workerPath),d.postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),d.addEventListener("message",function(e){"READY"===e.data?(d.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:t.realtime}),a().pipeTo(new WritableStream({write:function write(e){return o?void console.error("Got image, but recorder is finished!"):void d.postMessage(e.data.buffer,[e.data.buffer])}}))):!!e.data&&!n&&s.push(e.data)})}function r(e){return d?void(d.addEventListener("message",function(t){null===t.data&&(d.terminate(),d=null,e&&e())}),d.postMessage(null)):void(e&&e())}("undefined"==typeof ReadableStream||"undefined"==typeof WritableStream)&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),t=t||{},t.width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,t.realtime=t.realtime||!0;var o,d;this.record=function(){s=[],n=!1,this.blob=null,i(e),"function"==typeof t.initCallback&&t.initCallback()};var n;this.pause=function(){n=!0},this.resume=function(){n=!1};var s=[];this.stop=function(e){o=!0;var t=this;r(function(){t.blob=new Blob(s,{type:"video/webm"}),e(t.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){s=[],n=!1,this.blob=null},this.blob=null}var x,D,x,D;c.version="5.6.2",e.exports=c,x=[],D=function(){return c}.apply(t,x),!(void 0!==D&&(e.exports=D)),c.getFromDisk=function(e,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+("all"===e?"blobs":e+" blob ")+" from disk!"),W.Fetch(function(a,i){"all"!==e&&i===e+"Blob"&&t&&t(a),"all"===e&&t&&t(a,i.replace("Blob",""))})},c.writeToDisk=function(e){console.log("Writing recorded blob(s) to disk!"),e=e||{},e.audio&&e.video&&e.gif?e.audio.getDataURL(function(t){e.video.getDataURL(function(a){e.gif.getDataURL(function(e){W.Store({audioBlob:t,videoBlob:a,gifBlob:e})})})}):e.audio&&e.video?e.audio.getDataURL(function(t){e.video.getDataURL(function(e){W.Store({audioBlob:t,videoBlob:e})})}):e.audio&&e.gif?e.audio.getDataURL(function(t){e.gif.getDataURL(function(e){W.Store({audioBlob:t,gifBlob:e})})}):e.video&&e.gif?e.video.getDataURL(function(t){e.gif.getDataURL(function(e){W.Store({videoBlob:t,gifBlob:e})})}):e.audio?e.audio.getDataURL(function(e){W.Store({audioBlob:e})}):e.video?e.video.getDataURL(function(e){W.Store({videoBlob:e})}):e.gif&&e.gif.getDataURL(function(e){W.Store({gifBlob:e})})},g.getFromDisk=c.getFromDisk,g.writeToDisk=c.writeToDisk,"undefined"!=typeof c&&(c.MRecordRTC=g);(function(e){e&&"undefined"==typeof window&&"undefined"!=typeof a.g&&(a.g.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function getUserMedia(){}},!a.g.console&&(a.g.console={}),("undefined"==typeof a.g.console.log||"undefined"==typeof a.g.console.error)&&(a.g.console.error=a.g.console.log=a.g.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(e.document={documentElement:{appendChild:function appendChild(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function getContext(){return e},play:function play(){},pause:function pause(){},drawImage:function drawImage(){},toDataURL:function toDataURL(){return""},style:{}};return e},e.HTMLVideoElement=function(){}),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}),"undefined"==typeof O&&(e.URL={createObjectURL:function createObjectURL(){return""},revokeObjectURL:function revokeObjectURL(){return""}}),e.window=a.g)})("undefined"==typeof a.g?null:a.g);var M=window.requestAnimationFrame;if("undefined"==typeof M)if("undefined"!=typeof webkitRequestAnimationFrame)M=webkitRequestAnimationFrame;else if("undefined"!=typeof mozRequestAnimationFrame)M=mozRequestAnimationFrame;else if("undefined"!=typeof msRequestAnimationFrame)M=msRequestAnimationFrame;else if("undefined"==typeof M){var U=0;M=function(e){var t=Math.max,a=new Date().getTime(),i=t(0,16-(a-U)),r=setTimeout(function(){e(a+i)},i);return U=a+i,r}}var A=window.cancelAnimationFrame;"undefined"==typeof A&&("undefined"==typeof webkitCancelAnimationFrame?"undefined"==typeof mozCancelAnimationFrame?"undefined"==typeof msCancelAnimationFrame?"undefined"==typeof A&&(A=function(e){clearTimeout(e)}):A=msCancelAnimationFrame:A=mozCancelAnimationFrame:A=webkitCancelAnimationFrame);var E=window.AudioContext;"undefined"==typeof E&&("undefined"!=typeof webkitAudioContext&&(E=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(E=mozAudioContext));var O=window.URL;"undefined"==typeof O&&"undefined"!=typeof webkitURL&&(O=webkitURL),"undefined"!=typeof navigator&&"undefined"==typeof navigator.getUserMedia&&("undefined"!=typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!=typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var I=-1!==navigator.userAgent.indexOf("Edge")&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),B=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),j=-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&"netscape"in window&&/ rv:/.test(navigator.userAgent),P=!B&&!I&&!!navigator.webkitGetUserMedia||h()||-1!==navigator.userAgent.toLowerCase().indexOf("chrome/"),N=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);N&&!P&&-1!==navigator.userAgent.indexOf("CriOS")&&(N=!1,P=!0);var F=window.MediaStream;"undefined"==typeof F&&"undefined"!=typeof webkitMediaStream&&(F=webkitMediaStream),"undefined"!=typeof F&&"undefined"==typeof F.prototype.stop&&(F.prototype.stop=function(){this.getTracks().forEach(function(e){e.stop()})}),"undefined"!=typeof c&&(c.invokeSaveAsDialog=p,c.getTracks=f,c.getSeekableBlob=function(e,t){if("undefined"==typeof EBML)throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var a=new EBML.Reader,i=new EBML.Decoder,r=EBML.tools,o=new FileReader;o.onload=function(){var e=i.decode(this.result);e.forEach(function(e){a.read(e)}),a.stop();var o=r.makeMetadataSeekable(a.metadatas,a.duration,a.cues),d=this.result.slice(a.metadataSize),n=new Blob([o,d],{type:"video/webm"});t(n)},o.readAsArrayBuffer(e)},c.bytesToSize=m,c.isElectron=h);var z={};"undefined"==typeof E?"undefined"!=typeof webkitAudioContext&&(z.AudioContext=webkitAudioContext):z.AudioContext=E,"undefined"!=typeof c&&(c.Storage=z),"undefined"!=typeof c&&(c.MediaStreamRecorder=R),"undefined"!=typeof c&&(c.StereoAudioRecorder=S),"undefined"!=typeof c&&(c.CanvasRecorder=w),"undefined"!=typeof c&&(c.WhammyRecorder=y);var G=function(){function e(e){this.frames=[],this.duration=e||1,this.quality=.8}function t(e){var t=O.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),a=new Worker(t);return O.revokeObjectURL(t),a}function a(e){var t=String.fromCharCode;function a(e,t,a){return[{data:e,id:231}].concat(a.map(function(e){var a=l({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:o(t)});return t+=e.duration,{data:a,id:163}}))}function i(e){if(!e[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var t=e[0].width,a=e[0].height,r=e[0].duration,o=1;o<e.length;o++)r+=e[o].duration;return{duration:r,width:t,height:a}}function d(e){for(var t=[];0<e;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function n(e){return new Uint8Array(e.split("").map(function(t){return t.charCodeAt(0)}))}function c(e){var t=[],a=e.length%8?Array(9-e.length%8).join("0"):"";e=a+e;for(var r=0;r<e.length;r+=8)t.push(parseInt(e.substr(r,8),2));return new Uint8Array(t)}function u(e){for(var t,a=[],o=0;o<e.length;o++){t=e[o].data,"object"===_typeof(t)&&(t=u(t)),"number"==typeof t&&(t=c(t.toString(2))),"string"==typeof t&&(t=n(t));var l=t.size||t.byteLength||t.length,g=r(r(s(l)/s(2))/8),m=l.toString(2),p=Array(7*g+7+1-m.length).join("0")+m,h=Array(g).join("0")+"1"+p;a.push(d(e[o].id)),a.push(c(h)),a.push(t)}return new Blob(a,{type:"video/webm"})}function l(e){var a=0;if(e.keyframe&&(a|=128),e.invisible&&(a|=8),e.lacing&&(a|=e.lacing<<1),e.discardable&&(a|=1),127<e.trackNum)throw"TrackNumber > 127 not supported";var i=[128|e.trackNum,e.timecode>>8,255&e.timecode,a].map(function(a){return t(a)}).join("")+e.frame;return i}function g(e){for(var t=e.RIFF[0].WEBP[0],a=t.indexOf("\x9D\x01*"),r=0,o=[];4>r;r++)o[r]=t.charCodeAt(a+3+r);var d,n,s;return s=o[1]<<8|o[0],d=16383&s,s=o[3]<<8|o[2],n=16383&s,{width:d,height:n,data:t,riff:e}}function m(e,t){return parseInt(e.substr(t+4,4).split("").map(function(e){var t=e.charCodeAt(0).toString(2);return Array(8-t.length+1).join("0")+t}).join(""),2)}function p(e){for(var t=0,a={};t<e.length;){var i=e.substr(t,4),r=m(e,t),o=e.substr(t+4+4,r);t+=8+r,a[i]=a[i]||[],"RIFF"===i||"LIST"===i?a[i].push(p(o)):a[i].push(o)}return a}function h(e){return[].slice.call(new Uint8Array(new Float64Array([e]).buffer),0).map(function(a){return t(a)}).reverse().join("")}var f=new function(e){var t=i(e);if(!t)return[];for(var r=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:h(t.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:t.width,id:176},{data:t.height,id:186}]}]}]}]}],o=0,d=0;o<e.length;){var n=[],s=0;do n.push(e[o]),s+=e[o].duration,o++;while(o<e.length&&s<3e4);var c={id:524531317,data:a(d,0,n)};r[1].data.push(c),d+=s}return u(r)}(e.map(function(e){var t=g(p(atob(e.image.slice(23))));return t.duration=e.duration,t}));postMessage(f)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var i=t(a);i.onmessage=function(t){return t.data.error?void console.error(t.data.error):void e(t.data)},i.postMessage(this.frames)},{Video:e}}();"undefined"!=typeof c&&(c.Whammy=G);var W={init:function init(){function e(e){e.createObjectStore(a.dataStoreName)}function t(){function e(e){t.objectStore(a.dataStoreName).get(e).onsuccess=function(t){a.callback&&a.callback(t.target.result,e)}}var t=i.transaction([a.dataStoreName],"readwrite");a.videoBlob&&t.objectStore(a.dataStoreName).put(a.videoBlob,"videoBlob"),a.gifBlob&&t.objectStore(a.dataStoreName).put(a.gifBlob,"gifBlob"),a.audioBlob&&t.objectStore(a.dataStoreName).put(a.audioBlob,"audioBlob"),e("audioBlob"),e("videoBlob"),e("gifBlob")}var a=this;if("undefined"==typeof indexedDB||"undefined"==typeof indexedDB.open)return void console.error("IndexedDB API are not available in this browser.");var i,r=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),o=indexedDB.open(r,1);o.onerror=a.onError,o.onsuccess=function(){if(i=o.result,i.onerror=a.onError,!i.setVersion)t();else if(1!==i.version){var r=i.setVersion(1);r.onsuccess=function(){e(i),t()}}else t()},o.onupgradeneeded=function(t){e(t.target.result)}},Fetch:function Fetch(e){return this.callback=e,this.init(),this},Store:function Store(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function onError(e){console.error(JSON.stringify(e,null,"\t"))},dataStoreName:"recordRTC",dbName:null};"undefined"!=typeof c&&(c.DiskStorage=W),"undefined"!=typeof c&&(c.GifRecorder=k),"undefined"==typeof c&&(e.exports=C,x=[],D=function(){return C}.apply(t,x),!(void 0!==D&&(e.exports=D))),"undefined"!=typeof c&&(c.MultiStreamRecorder=T),"undefined"!=typeof c&&(c.RecordRTCPromisesHandler=function(e,t){if(!this)throw"Use \"new RecordRTCPromisesHandler()\"";if("undefined"==typeof e)throw"First argument \"MediaStream\" is required.";var a=this;a.recordRTC=new c(e,t),this.startRecording=function(){return new Promise(function(e,t){try{a.recordRTC.startRecording(),e()}catch(a){t(a)}})},this.stopRecording=function(){return new Promise(function(e,t){try{a.recordRTC.stopRecording(function(i){return a.blob=a.recordRTC.getBlob(),a.blob&&a.blob.size?void e(i):void t("Empty blob.",a.blob)})}catch(a){t(a)}})},this.pauseRecording=function(){return new Promise(function(e,t){try{a.recordRTC.pauseRecording(),e()}catch(a){t(a)}})},this.resumeRecording=function(){return new Promise(function(e,t){try{a.recordRTC.resumeRecording(),e()}catch(a){t(a)}})},this.getDataURL=function(){return new Promise(function(e,t){try{a.recordRTC.getDataURL(function(t){e(t)})}catch(a){t(a)}})},this.getBlob=function(){return new Promise(function(e,t){try{e(a.recordRTC.getBlob())}catch(a){t(a)}})},this.getInternalRecorder=function(){return new Promise(function(e,t){try{e(a.recordRTC.getInternalRecorder())}catch(a){t(a)}})},this.reset=function(){return new Promise(function(e,t){try{e(a.recordRTC.reset())}catch(a){t(a)}})},this.destroy=function(){return new Promise(function(e,t){try{e(a.recordRTC.destroy())}catch(a){t(a)}})},this.getState=function(){return new Promise(function(e,t){try{e(a.recordRTC.getState())}catch(a){t(a)}})},this.blob=null,this.version="5.6.2"}),"undefined"!=typeof c&&(c.WebAssemblyRecorder=L)}},a={};(function(){e.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(a,{a:a}),a}})(),function(){e.d=function(t,a){for(var i in a)e.o(a,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:a[i]})}}(),function(){e.g=function(){if("object"===("undefined"==typeof globalThis?"undefined":_typeof(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===("undefined"==typeof window?"undefined":_typeof(window)))return window}}()}(),function(){e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}();var i={};return function(){"use strict";e.d(i,{default:function _default(){return d}});var t=e(204),a=e.n(t),r=e(212),o=e.n(r),d=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{mic:!0,speaker:!0},a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){};_classCallCheck(this,e),this.recorder=[],this.mediaStream=null,this.mediaStreamMic=null,this.mic=t.mic,"undefined"==typeof t.mic&&(this.mic=!0),this.speaker=t.speaker,"undefined"==typeof t.speaker&&(this.speaker=!0),this.callbackStreamSuccess=a,this.callbackStreamError=r,this.callbackStreamStop=i}return _createClass(e,[{key:"getMediaDevices",value:function getMediaDevices(){return navigator.mediaDevices.getDisplayMedia?navigator.mediaDevices:navigator.getDisplayMedia?navigator:null}},{key:"captureMicrophone",value:function captureMicrophone(e){return e.getUserMedia({audio:!0,video:!1})}},{key:"captureSpeaker",value:function captureSpeaker(e){return e.getDisplayMedia({audio:!0,video:!0})}},{key:"stopListener",value:function stopListener(){var e=this,t=!1,a=function(){!1===t&&e.recorder.stopRecording(function(){e.callbackStreamStop(e.recorder.getBlob()),e.recorder.destroy(),e.recorder=null}),t=!0};this.mediaStream.addEventListener("ended",a,!1),this.mediaStream.addEventListener("inactive",a,!1),this.mediaStream.getTracks().forEach(function(e){e.addEventListener("ended",a,!1),e.addEventListener("inactive",a,!1)})}},{key:"start",value:function start(){var e=this,t=this.getMediaDevices();return null===t?void this.callbackStreamError():void this.captureMicrophone(t).then(function(i){e.captureSpeaker(t).then(function(t){var r=[];e.mic&&r.push(i),e.speaker&&r.push(t);var d=new(a())(r),n=d.getMixedStream();e.recorder=o()(n,{type:"audio"}),e.mediaStream=t,e.mediaStreamMic=i,e.recorder.startRecording(),e.stopListener(),e.callbackStreamSuccess(n,e.recorder)})["catch"](function(e){throw new Error(e)})})["catch"](function(t){console.error(t),e.callbackStreamError()})}},{key:"stop",value:function stop(){this.mediaStream.stop(),this.mediaStreamMic.stop(),this.mediaStream=null}}]),e}()}(),i=i["default"],i}()});